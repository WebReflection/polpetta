{"tagline":"Polpetta, any folder is served spiced","name":"Polpetta","body":"(á€€) Polpetta\r\n===========================\r\nany folder is served spiced\r\n\r\n![polpetta at work](http://www.3site.eu/images/polpetta_shell.png)\r\n___________________________\r\n\r\n\r\nWhat Is Polpetta\r\n----------------\r\n*polpetta* is a script able to initialize a [node.js](http://nodejs.org/) server in any folder you want and behave like *CGI* or, if you prefer *PHP*, too, in order to have **not static files serving only but dynamic content as well**.\r\n\r\n\r\n`node polpetta ~/path` is basically all you need to start surfing the `~/path` folder as if it is a web-server with the plus that any *file.njs* inside that folder will act as *node.js* module.\r\nHere [the most basic example of an *index.njs* file](https://github.com/WebReflection/polpetta/blob/master/test/index.njs).\r\n\r\nIn few words, **polpetta is the easiest way for quick prototyping with both client files and node.js modules**.\r\n\r\n\r\nHow Is Polpetta Different From Python SimpleHTTPServer, serverdir, etc\r\n----------------------------------------------------------------------\r\nThe JavaScript weekly description couldn't be more precise\r\n\r\n\r\n    Runs up a Node-powered HTTP server in any folder you want whereupon '.njs' files get executed CGI-style.\r\n\r\n\r\nAnd this is almost it, except it finds automatically an available port if not specified, so you don't have to bother inventing numbers by your own, it allows interceptions on files via *.htaccess* like mechanism, and it `require(\"folder/file.njs\")` to let you test modules for node.js in the possible easiest way ever, without writing from scratch again and again something able to run a web server.\r\n\r\n\r\nCan I Use Polpetta In Production ?\r\n----------------------------------\r\nYou are using node.js which is not even at release 1.0 so I would say yes, you can :{D\r\n\r\nHowever, there are more mature projects such [Express](http://expressjs.com) probably with some hosting possibility.\r\nYou can still test Express node.js modules in *polpetta* with a \"*zero effort kick-in*\" process: type *polpetta* in that folder and you are basically done.\r\n\r\nMoreover, *polpetta* can be a solution for embedded devices able to run node.js thanks to all possible techniques used to minimize creation of pointless objects, recycle as much as possible in a single thread, and a simplified behavior able to cover most of web cases.\r\nLast, but not least, I am willing to rent a server and use *polpetta* there so .. stay tuned :-)\r\n\r\n\r\nDoes It Run This And That ?\r\n---------------------------\r\n*polpetta* runs everything available with **npm** with a secured mechanism that disable browsers from reading any **node_modules** folder present in your project tree (together with hidden files prefixed via a simple **.** dot).\r\nIf you have written a node.js module, *polpetta* will be more than happy to let you use it, or test it, in a simple, and familiar, *onload* exported callback.\r\n\r\n\r\nSupported Platforms\r\n-------------------\r\n*polpetta* should just work wherever a recent version of node.js is available.\r\nKnown platforms are **Linux**, **Mac**, and **Windows** where for latter one the *polpetta.cmd* file will simply start a polpetta server through double click.\r\n\r\n\r\nUsage\r\n-----\r\nSame as [serverdir](https://github.com/remy/servedir)\r\n\r\n    polpetta [path] [port]\r\n\r\n  * **path**, the folder you want to use as web-server root, by default is where *polpetta* is\r\n  * **port**, the port you want to use, by default *polpetta* finds a free port automatically\r\n\r\nBear in mind if you specify a port and it's not available, *polpetta* will exit with a notice in console.\r\n\r\nIf you don't remember later on ... `polpetta --help` or `polpetta -h` to have some hint.\r\n\r\n\r\nOK, How Do I Start\r\n------------------\r\nWell, the very first step is to grab *polpetta*, either via `git clone git://github.com/WebReflection/polpetta.git` or simply getting the unique file.\r\n\r\nYou can install *polpetta* through `npm install polpetta -g` or you can grab directly a freshly baked polpetta:\r\n\r\n    # go in a directory, if emty is better\r\n    # grab the built file from this repo\r\n    curl -0 https://raw.github.com/WebReflection/polpetta/master/build/polpetta >polpetta\r\n\r\n    # if you don't want to make\r\n    # polpetta executable\r\n    # point to polpetta via node\r\n    node ~/the/path/where/is/polpetta\r\n\r\n    # if you want make it executable\r\n    # be sure polpetta firstline points to the right\r\n    # bin folder with node then chmod it\r\n    chmod +x polpetta\r\n\r\n    # if that is the case, test if it runs via\r\n    # and exit via Ctrl+C or simply go to\r\n    # the http://address:port/ showed and start playing\r\n    ./polpetta\r\n\r\nYou should see something like this in your console (I have used the /tmp folder here)\r\n\r\n![polpetta at work](http://www.3site.eu/images/polpetta_shell.png)\r\n\r\n\r\n    # if you want make your life easier and call\r\n    # polpetta from anywhere, hoping you have not\r\n    # configured node as super user ( this could hurt )\r\n    which node\r\n    # output: /usr/local/bin/node\r\n\r\n    # move the file into that bin folder\r\n    [sudo] mv polpetta /usr/local/bin\r\n\r\n    # now, whatever folder you want ..\r\n    polpetta ~/myhtml/only/website/\r\n\r\n    # and you are ready to go\r\n\r\nIf you want clone this repository, help me improving *polpetta* or do some test/change, remember to `make` in order to build *polpetta* in the build folder then `node build/polpetta test` or any other path you like.\r\n\r\n\r\nMake options\r\n------------\r\n  * **build**, the default one, creates a freshly new backed *polpetta* in the *build/* folder\r\n  * **clean**, remove the build folder and everything included\r\n  * **types**, grab the Apache file, parse it, overwrite the [EXTENSION_TO_MIME.js](https://github.com/WebReflection/polpetta/blob/master/src/EXTENSION_TO_MIME.js) file and build *polpetta* again\r\n\r\n\r\nWhat About .njs Files\r\n---------------------\r\nIf the file extension is **.njs** it is **executed CGI (or PHP) style** but with the whole power of node.js.\r\nYou can `require(\"module\")` and do what you want and you receive per each web-server call the **request** and the **response** object.\r\nAll you have to do in your file is to export an `onload` function. This function will be called with a spiced up *polpetta* with some utility but you don't really have to use them, just do what you want.\r\n\r\n    // generic.njs file\r\n    this.onload = function (\r\n      request,\r\n      response,\r\n      polpetta\r\n    ) {\r\n      var fs = require(\"fs\");\r\n      fs.writeFileSync(\"gotcha.txt\", \"it works\");\r\n      response.end();\r\n      // note that polpetta here points\r\n      // to a new polpetta instance\r\n      // per each request lifecycle\r\n    };\r\n\r\n\r\nWhat About External npm Modules\r\n-------------------------------\r\nThere are two options here, the easy one and the even easier.\r\nThe easy one is about putting your modules in a folder called **node_modules** inside your project.\r\nThis folder is forbidden by default so nobody can read it through the url but you can `require(module)` without problems.\r\n\r\nThe even easier way is to install your most used modules globally via `npm install module -g` so that these will be available in any case through the node.js `require()` mechanism and you update one place rather than all of them, if necessary.\r\n\r\n\r\nWhat About Polpetta as Module\r\n-----------------------------\r\nIf you `require(\"./polpetta\")` file you gonna have a module with a *Polpetta* constructor.\r\nAny time you want to initialize a Polpetta instance you can `new Polpetta(request, response)`.\r\nAs easy way to use it for generic http server response, you can `http.createServer(Polpetta.factory);`\r\n\r\n\r\nWhat About .htaccess file\r\n-------------------------\r\nThe *.htaccess* file is a feature that lets you intercept few calls such *onrequest*, *onstaticfile*, and *onerror*.\r\nYou can find a\r\n[.htaccess example here](https://github.com/WebReflection/polpetta/blob/master/test/weird folder/.htaccess).\r\nThe .htaccess file works only if present in the root folder you chose for a polpetta instance. In all other folders this will be threaten as an hidden file rather than being parsed per each folder request. This simplifies and boost up **a lot** the server logic and is most likely everything you need. Here a summary of all current methods invoked, if present, with the .htaccess file.\r\n\r\n  * **onrequest**, performed *while polpetta is still backing*, you can use this event to create your own redirects, internals or external, or do any sort of crazy things you might think about.\r\n  * **onstaticfile**, performed once a non CGI/.njs file is going to be served. Here you can serve gzipped content or a completely different layout, accordingly with the file type.\r\n  * **onerror**, performed when something bad occurs. Usually, for bad we mean a forbidden 403, a not found 404, or an internal server error, with code 500. Here you can serve an alternative nice page, informing the user something went wrong or so something else, if you think it's necessary.\r\n\r\nEvery time a callback is invoked, the [event object](https://github.com/WebReflection/polpetta/blob/master/src/htaccess/invokedHtaccess.js) will be sent. If you want to stop a default polpetta behavior, simply use `even.preventDefault()` or `return false` at some point in the callback. This works like DOM Level 3 or DOM 0 events ... as easy as that.\r\n\r\n\r\nPolpetta API\r\n------------\r\nYou can find almost everything documented in the [prototype.js](https://github.com/WebReflection/polpetta/blob/master/src/Polpetta/prototype.js) file.\r\nLook closer and you will find a `polpetta.get(key[, default])` method, used to retrieve query string properties as it is for the PHP `$_GET[$key]` global, a `polpetta.post(key[, default])` method to retrieve posted data, a `polpetta.cookie(key[, default])` method, to get cookie, followed by `polpetta.cookie.set(key, value)` to set them.\r\nAll these objects have a `obj.keys()` method too to retrieve all parsed keys for *get*, *post*, *cookie*, or *file*.\r\n\r\nYou can see an examples for [cookie](https://github.com/WebReflection/polpetta/blob/master/test/cookie.njs), [get or post](https://github.com/WebReflection/polpetta/blob/master/test/post.njs), and [files upload](https://github.com/WebReflection/polpetta/blob/master/test/file.njs) in the test folder.\r\n\r\nLast, but not least, there is a `polpetta.output` **Array** property where you can push your content and `polpetta.output.flush([type || [code, type]])` once you have done.\r\nBear in mind this is not a good technique to serve big files on the fly but that's not the purpose of the `output` property.\r\n\r\n    // example of get and output\r\n    this.onload = function (req, res, p) {\r\n      p.output.push(\r\n        \"Hello \",\r\n          p.get(\"name\",\r\n            // default if not present\r\n            \"unknown\"\r\n          ),\r\n        \"!\"\r\n      );\r\n      p.output.flush(\"txt\");\r\n    };\r\n\r\n    // produced output for localhost:port\r\n    Hello unknown!\r\n\r\n    // produced output for localhost:port/?name=Polpetta\r\n    Hello Polpetta!\r\n\r\n\r\nLicense\r\n-------\r\nThis *polpetta* project is under the Mit Style License\r\n\r\n    Copyright (C) 2011 by Andrea Giammarchi, @WebReflection\r\n\r\n    Permission is hereby granted, free of charge, to any person obtaining a copy\r\n    of this software and associated documentation files (the \"Software\"), to deal\r\n    in the Software without restriction, including without limitation the rights\r\n    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n    copies of the Software, and to permit persons to whom the Software is\r\n    furnished to do so, subject to the following conditions:\r\n\r\n    The above copyright notice and this permission notice shall be included in\r\n    all copies or substantial portions of the Software.\r\n\r\n    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n    THE SOFTWARE.\r\n\r\n\r\nTODOs\r\n-----\r\n  * pipe/stream files bigger than a predefined amount of MB (or just pipe them all)\r\n  * reach more coverage through [wru](https://github.com/WebReflection/wru) tests (integrated in the build system)\r\n  * add default favicon with polpetta logo (or maybe not ....)\r\n  * ... something else you can suggest me :-)\r\n\r\n\r\nLogo\r\n----\r\nPolpetta means meatball and I am not a graphic designer at all ... so this is all I could do but if you want to create a better logo, you'll be credited and I'll pay you a beer, cheers :D\r\n\r\n![logo](https://github.com/WebReflection/polpetta/raw/master/test/img/polpetta.png)\r\n\r\n\r\nOh Gosh ... Why\r\n---------------\r\nI am maintaining different projects and I am sick of setting up a web-server per each project.\r\nYou might have noticed that most **recent browsers do not let us test through the *file://* protocol anymore** and this is the most annoying thing ever for a developer, imho.\r\nYou might be a *node.js* modules developer too and sometimes an easy way to test your modules is all you need.\r\nWith *polpetta* you can create as many server as you want per each folder and test them without setting up a damn thing.\r\nAccordingly, if you develop anything for the web or the *node.js* community, *polpetta* could be exactly the solution to all your problems.\r\n","note":"Don't delete this file! It's used internally to help with page regeneration.","google":""}